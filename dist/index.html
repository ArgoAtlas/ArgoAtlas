<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link href="styles.css" rel="stylesheet" />
    <title>ArgoAtlas</title>
  </head>
  <body>
    <div id="tooltip"></div>
    <div id="map"></div>
    <script src="main.js" defer></script>

    <div class="checkbox-dropdown">
      ‎ Filters
      <ul class="checkbox-dropdown-list">
        <li>
          <label>
            <input type="checkbox" id="portsCheck" checked /> Ports
          </label>
        </li>
        <li>
          <label>
            <input type="checkbox" id="shipsCheck" checked /> Ships
          </label>
        </li>
        <li>
          <label>
            <input type="checkbox" id="chokepointsCheck" checked /> Major
            Chokepoints
          </label>
        </li>
        <li>
          <label>
            <input type="checkbox" id="chokepointsSecondaryCheck" checked />
            Secondary Chokepoints
          </label>
        </li>
      </ul>
    </div>

    <div class="layers-dropdown">
      ‎ Layer Elements
      <ul class="layers-dropdown-list">
        <li>
          <div class="elements-dropdown">
            <label> Ports </label>
            <ul id="mpj" class="elements-dropdown-list"></ul>
            <!-----------------ports displayed here in a list-------------------->
          </div>
        </li>
        <li>
          <div class="elements-dropdown">
            <label> Ships </label>
            <ul id="mpjj" class="elements-dropdown-list"></ul>
            <!-----------------ships displayed here in a list-------------------->
          </div>
        </li>
        <li>
          <div class="elements-dropdown">
            <label> Major Chokepoints </label>
            <ul id="mpjjj" class="elements-dropdown-list"></ul>
            <!-----------------chokepoints displayed here in a list-------------------->
          </div>
        </li>
        <li>
          <div class="elements-dropdown">
            <label> Secondary Chokepoints </label>
            <ul id="mpjjjj" class="elements-dropdown-list"></ul>
            <!-----------------secondary chokepoints displayed here in a list-------------------->
          </div>
        </li>
      </ul>
    </div>

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script>
      $(".checkbox-dropdown").click(function () {
        $(this).toggleClass("is-active");
      });

      $(".checkbox-dropdown ul").click(function (e) {
        e.stopPropagation();
      });

      $(".layers-dropdown").click(function () {
        $(this).toggleClass("iss-active");
      });

      $(".layers-dropdown ul").click(function (e) {
        e.stopPropagation();
      });

      $(".elements-dropdown").click(function () {
        $(this).toggleClass("isss-active");
        $(this).toggleClass("issss-active");
      });

      $(".elements-dropdown ul").click(function (e) {
        e.stopPropagation();
      });
    </script>

    <script>
      const serverAddress = "http://localhost:5000";
      var i = 0;
      main();

      async function main() {
        const portsResponse = await fetch(`${serverAddress}/ports`);
        const shipsResponse = await fetch(`${serverAddress}/ships`);
        const chokepointsResponse = await fetch(`${serverAddress}/chokepoints`);
        const chokepointsSecondaryResponse = await fetch(
          `${serverAddress}/chokepointsSecondary`,
        );

        const ports = await portsResponse.json();
        const ships = await shipsResponse.json();
        const chokepoints = await chokepointsResponse.json();
        const chokepointsSecondary = await chokepointsSecondaryResponse.json();

        const portsUl = document.getElementById("mpj");
        const shipsUl = document.getElementById("mpjj");
        const chokepointsUl = document.getElementById("mpjjj");
        const chokepointsSecondaryUl = document.getElementById("mpjjjj");

        for (const port of ports.features) {
          portsUl.innerHTML += `<li><label>${port.properties.name}</label><li>`;
        }
        for (const ship of ships) {
          i++;
          if (i < 200) {
            shipsUl.innerHTML += `<li><label>${ship.name}</label><li>`;
          }
        }
        for (const chokepoint of chokepoints) {
          chokepointsUl.innerHTML += `<li><label>${chokepoint.name}</label><li>`;
        }
        for (const chokepointSecondary of chokepointsSecondary) {
          chokepointsSecondaryUl.innerHTML += `<li><label>${chokepointSecondary.id}</label><li>`;
        }
      }
    </script>
  </body>
</html>
